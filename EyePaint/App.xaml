<Application x:Class="EyePaint.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <Style x:Key="FullScreen" TargetType="Window">
            <Setter Property="Background" Value="Black" />
            <Setter Property="Cursor" Value="None" />
            <Setter Property="ResizeMode" Value="NoResize" />
            <Setter Property="WindowStyle" Value="None" />
            <Setter Property="WindowState" Value="Maximized" />
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="/EyePaint;component/Resources/#ITC Officina Sans Std" />
            <Setter Property="Foreground" Value="White" />
        </Style>
        <Storyboard x:Key="GazeClickStoryboard" CurrentTimeInvalidated="onGazeClick" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="ScaleTransform" Storyboard.TargetProperty="ScaleY" To="0">
                <DoubleAnimation.EasingFunction>
                    <PowerEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="ScaleTransform" Storyboard.TargetProperty="ScaleX" To="0">
                <DoubleAnimation.EasingFunction>
                    <PowerEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="CancelGazeClickStoryboard">
            <DoubleAnimation Storyboard.TargetName="ScaleTransform" Storyboard.TargetProperty="ScaleY" To="1" />
            <DoubleAnimation Storyboard.TargetName="ScaleTransform" Storyboard.TargetProperty="ScaleX" To="1" />
        </Storyboard>
        <ControlTemplate x:Key="GazeButton" TargetType="Button">
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Opacity" Value="0.9" />
                    <Setter Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Self}}" />
                </Trigger>
                <Trigger Property="IsMouseOver" Value="False">
                    <Setter Property="Opacity" Value="0.5" />
                </Trigger>
                <EventTrigger RoutedEvent="MouseEnter">
                    <BeginStoryboard Name="GazeButtonAnimation">
                        <StaticResource ResourceKey="GazeClickStoryboard"/>
                    </BeginStoryboard>
                </EventTrigger>
                <EventTrigger RoutedEvent="PreviewMouseDown">
                    <StopStoryboard BeginStoryboardName="GazeButtonAnimation" />
                </EventTrigger>
                <EventTrigger RoutedEvent="MouseLeave">
                    <BeginStoryboard>
                        <StaticResource ResourceKey="CancelGazeClickStoryboard"/>
                    </BeginStoryboard>
                    <StopStoryboard BeginStoryboardName="GazeButtonAnimation" />
                </EventTrigger>
            </ControlTemplate.Triggers>
            <Grid Background="Transparent">
                <Grid RenderTransformOrigin="0.5,0.5">
                    <Grid.RenderTransform>
                        <ScaleTransform x:Name="ScaleTransform" ScaleY="1" ScaleX="1" />
                    </Grid.RenderTransform>
                    <Ellipse Fill="{TemplateBinding Foreground}">
                        <Ellipse.Effect>
                            <DropShadowEffect BlurRadius="0" ShadowDepth="1" Color="{TemplateBinding Background}"/>
                        </Ellipse.Effect>
                    </Ellipse>
                    <Border Name="Mask" Background="Black" Margin="10" CornerRadius="{Binding ActualWidth, Mode=OneWay, RelativeSource={RelativeSource Self}}" />
                    <Grid Background="{TemplateBinding Background}" Margin="10">
                        <Grid.OpacityMask>
                            <VisualBrush Visual="{Binding ElementName=Mask}" />
                        </Grid.OpacityMask>
                        <ContentPresenter Content="{TemplateBinding Content}"/>
                        <Viewbox Margin="20" VerticalAlignment="Center">
                            <TextBlock TextAlignment="Center" Text="{TemplateBinding Tag}" Foreground="{TemplateBinding Foreground}">
                                <TextBlock.Effect>
                                    <DropShadowEffect BlurRadius="0" ShadowDepth="1" Color="#3F000000"/>
                                </TextBlock.Effect>
                            </TextBlock>
                        </Viewbox>
                    </Grid>
                </Grid>
            </Grid>
        </ControlTemplate>
    </Application.Resources>
</Application>
